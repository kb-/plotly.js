<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Plotly Tooltip Button Test</title>
    <script src="../dist/plotly.js"></script>
    <!-- <script src="../dist/plotly-locale-de.js"></script> -->
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #plot {
            width: 100%;
            height: 600px;
        }
    </style>
</head>
<body>
    <h1>Plotly Tooltip Button Test</h1>
    <div id="plot"></div>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
        
            // Generate date and time values
            function generateDateTime(start, count) {
                let dates = [];
                let current = new Date(start);
                for (let i = 0; i < count; i++) {
                    dates.push(new Date(current));
                    current.setHours(current.getHours() + 7);
                }
                return dates;
            }
            
            // Generate random y-values
            function generateRandomYValues(count) {
                return Array.from({ length: count }, () => Math.random() * 20);
            }
            
            // Generate data points
            var xValues = generateDateTime('2024-04-01T12:00:00Z', 10);

            var trace1 = {
                name: 'Trace 1',
                x: generateDateTime('2024-04-01T12:00:00Z', 5),
                y: generateRandomYValues(5),
                type: 'scatter',
                tooltiptemplate: "%{fullData.name}<br>%{x|%H:%M:%S}<br>y: %{y:.2e}",
                tooltip: {
                    align: 'left',
                    arrowcolor: 'blue',
                    arrowhead: 2,
                    arrowsize: 1.2,
                    arrowwidth: 1,
                    font: {
                        color: 'red',
                        family: 'Arial',
                        size: 16
                    },
                    showarrow: true,
                    xanchor: 'left'
                }
            };
            
            var trace2 = {
                name: 'Trace 2',
                x: generateDateTime('2024-04-01T12:00:00Z', 5),
                y: generateRandomYValues(5),
                type: 'scatter',
                tooltiptemplate: "%{fullData.name}<br>%{x|%H:%M:%S}<br>y: %{y:.2e}",
            };
            
            var data = [trace1, trace2];
            
            var layout = {
                title: 'Custom Tooltip Example'
            };

            var config = {
                editable: true,//editable is important to allow Tooltip drag-positionning and deletion
                modeBarButtonsToAdd: ['tooltip', 'hoverclosest', 'hovercompare', 'togglespikelines'],  // Add the tooltip button
                displaylogo: false,  // Optionally hide the Plotly logo
                displayModeBar: true,  // Ensure the modebar is displayed
                locale: 'de'
            };

            Plotly.newPlot('plot', data, layout, config).then(function() {
                // Wait for the plot to be fully initialized before querying the button
                var tooltipButton = document.querySelector('.modebar-btn[data-title="Add Tooltip to Points"]');

                if (tooltipButton) {
                    tooltipButton.addEventListener('click', function() {
                        console.log('Tooltip button clicked');
                    });
                } else {
                    console.error('Tooltip button not found');
                }
            });
        });
    </script>
</body>
</html>
